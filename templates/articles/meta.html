{% load base_filters %}
{% load perm_tags %}
{% load tagging_tags %}
{% load category_tags %}
{% load i18n %}

{% has_perm user articles.change_article search_object as can_edit %}
{% has_perm user articles.delete_article search_object as can_delete %}
{% get_category_for_object search_object as category %}
{% get_sub_category_for_object search_object as sub_category %}
{% tags_for_object search_object as tags %}


            <div class="meta">
    			<div class="meta-left">
                	<div class="submitted"><strong>{% trans "Released:" %}</strong> {{ search_object.release_dt|date:"long" }}
                	{% if search_object.creator.first_name %}
                	 {% trans "by" %} {% if user.is_authenticated %}
                	 <a href="{{ search_object.creator.get_absolute_url }}">{{ search_object.creator.first_name }} {{ search_object.creator.last_name }}</a>
                	   {% else %}
                	   {{ search_object.creator.first_name }} {{ search_object.creator.last_name }}
                	   {% endif %}
                    {% endif %}
                    </div>
                    
                    {% if not search_view %}
                        {% if search_object.source %}
                        <div class="submitted"><strong>{% trans "Source:" %}</strong> {{ search_object.source|urlize }}</div>
    			        {% endif %}
    			        
    			        {% if search_object.first_name or search_object.last_name or search_object.phone or search_object.fax or search_object.email or search_object.website %} 
            			<div class="contact">
            				{% if search_object.first_name or search_object.last_name %}
            					<div>{{ search_object.first_name }} {{ search_object.last_name }}</div>
            				{% endif %}	
            				{% if search_object.phone %}
            					<div>{{ search_object.phone }}</div>	
            				{% endif %}	
            				{% if search_object.fax %}
            					<div>{{ search_object.fax }}</div>	
            				{% endif %}	
            				{% if search_object.email %}
            				<div>{{ search_object.email|obfuscate_email }}</div>
            				{% endif %}
            				{% if search_object.website %}	
            				<div>{{ search_object.website|urlize }}</div>	
            				{% endif %}
            			</div> 
            			{% endif %}
                    {% endif %}
                	
    				{% if category %}
    				<div class="categories">
    					<strong>{% trans "Category:" %} </strong><a href="{% url article.search %}?q=category:{{ category }}">{{ category }}</a>
    				{% if sub_category %}
    					| <strong>{% trans "Sub Category:" %} </strong><a href="{% url article.search %}?q=sub_category:{{ sub_category }}">{{ sub_category }}</a>
    				{% endif %}	
    				</div>
    				{% endif %}
    
                	{% if tags %}
    				<div class="tags"><strong>{% trans "Tags:" %} </strong>
    					{% for tag in tags %}
    						<a href="{% url article.search %}?q=tag:{{ tag }}">{{ tag }}</a>{% if not forloop.last %}, {% endif %}
    					{% endfor %}
    				</div>
    				{% endif %}
                    
                    {% if can_edit %}
                	<div class="submitted">{% blocktrans with search_object.update_dt|date:"long" as update_date %}Last updated {{ update_date }}
                	by:{% endblocktrans %} <a href="{{ search_object.owner.get_absolute_url }}">
                	{% if search_object.owner.first_name %}{{ search_object.owner.first_name }} {{ search_object.owner.last_name }}
                    {% else %}
                      {{ search_object.owner }}
                    {% endif %}</a>
                    </div>
                    {% endif %}
                </div>
                <div class="meta-right">
    				<!-- <a class="print-link" href="{# url article.print_view article.slug #}">Print</a> -->
    				<a class="share-link" >{% trans "Share" %}</a>
                </div>
            </div>
            {% if can_edit %}
            <div class="editor-bar">

                <div class="perm-status">
                <ul>
                    <li>{% obj_perms search_object %}</li>
                    <li>{% obj_status search_object %}</li>
                </ul>
                </div>
                <div class="edit-links">
                <ul>
                    <li><a class="eventlog-link" href="{% url event_log.search %}?q=app-id:%20articles-{{ search_object.pk }}">{% trans "Eventlogs" %}</a></li>
                    <li><a class="edit-link" href="{% url article.edit search_object.pk %}">{% trans "Edit" %}</a></li>
                    <li><a class="options-link" href="#">{% trans "Options" %} <small>&#9650;</small></a>
                    <div class="options-list">
                        <ul>
                        {% if can_delete %}
    					<li>
    						<a class="delete" href="{% url article.delete search_object.pk %}">{% trans "Delete" %}</a>
    					</li>				
    				    {% endif %}
                            <li><a href="{% url article.edit.meta search_object.pk %}">{% trans "Edit Meta" %}</a></li>
                            <li><a href="{% url category.update search_object.opt_app_label search_object.opt_module_name search_object.pk %}">{% trans "Edit Categories" %}</a></li>
                            
                        </ul>
                    </div>
                    </li>
                </ul>
                </div>
            </div> 
            {% endif %}
