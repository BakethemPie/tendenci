{% load base_filters %}
{% load base_tags %}
{% load cache %}
{% load box_tags %}
{% load story_tags %}
{% load news_tags %}
{% load event_tags %}
{% load theme_tags %}
{% load i18n %}

{% theme_extends 'base.html' %}

{% block extra_head %}
{{ block.super }}
    <link rel="shortcut icon" href="{{ THEME_URL }}media/images/favicon.ico">
    <link rel="apple-touch-icon" href="{{ THEME_URL }}media/images/apple-touch-icon.png">
    <link rel="stylesheet/less" href="{{ THEME_URL }}media/css/styles.less" type="text/css" media="screen" />
    <script src="{{ THEME_URL }}media/js/less-1.1.3.min.js" type="text/javascript"></script>
    <script src="{{ THEME_URL }}media/js/libs/modernizr-1.6.min.js" type="text/javascript"></script>
{% endblock extra_head %}

{% block body_ids %}home{% endblock body_ids %}
{% block body_classes %}home{% endblock body_classes %}

{% block html_body %}
<div id="wrapper">
    <div class="container">
        <section id="header">
    {% theme_include "header.html" %}
       </section><!-- /#header -->
    </div>
    <div class="container">
        <section id="rotator" class="clearfix">
            <div id="stories">
                {% list_stories as featured_stories limit=4 %}
                {% if featured_stories %}
                {% for story in featured_stories %}
                <div class="story story-{{ forloop.counter }}">
                    <img src="{% image_url story.image size=940x540 crop=true quality=90 %}" />
                    <div class="blurb">
                        <h2><a href="{{ story.full_story_link }}">{{ story.title }}</a></h2>
                        <p>{{ story.content|striptags|truncatewords:"16"|safe }} <a class="readmore" href="{{ story.full_story_link }}">Read more</a></p>
                        <span id="story-label-{{ forloop.counter0 }}" class="story-label">{{ story.title|truncatewords:"1"|slice:"-4" }}</span>
                    </div>
                </div><!-- /.story-{{ forloop.counter }} -->
                {% endfor %}
                {% else %}
                <div class="story">
                    <img src="http://media.tendenciapp.com/images/rotator.jpg" />
                    <div class="blurb">
                        <h2><a href="/">Sample Story</a></h2>
                        <p>Great new content. {% if request.user.is_authenticated %}<a href="/stories/add/">Add your first story</a> to take the place of this photo. Be sure to <strong>tag it rotator</strong> so that it shows up in this area.{% endif %}</p>
                        <span id="story-label-0" class="story-label">Network</span>
                    </div>
                </div>
                <div class="story">
                    <img src="http://media.tendenciapp.com/images/rotator.jpg" />
                    <div class="blurb">
                        <h2><a href="/">Story number 2</a></h2>
                        <p>Great new content. {% if request.user.is_authenticated %}<a href="/stories/add/">Add your first story</a> to take the place of this photo. Be sure to <strong>tag it rotator</strong> so that it shows up in this area.{% endif %}</p>
                        <span id="story-label-1" class="story-label">Join</span>
                    </div>
                </div>
                <div class="story">
                    <img src="http://media.tendenciapp.com/images/rotator.jpg" />
                    <div class="blurb">
                        <h2><a href="/">Sample Story</a></h2>
                        <p>Great new content. {% if request.user.is_authenticated %}<a href="/stories/add/">Add your first story</a> to take the place of this photo. Be sure to <strong>tag it rotator</strong> so that it shows up in this area.{% endif %}</p>
                        <span id="story-label-2" class="story-label">Jobs</span>
                    </div>
                </div>
                <div class="story">
                    <img src="http://media.tendenciapp.com/images/rotator.jpg" />
                    <div class="blurb">
                        <h2><a href="/">Story number 2</a></h2>
                        <p>Great new content. {% if request.user.is_authenticated %}<a href="/stories/add/">Add your first story</a> to take the place of this photo. Be sure to <strong>tag it rotator</strong> so that it shows up in this area.{% endif %}</p>
                        <span id="story-label-3" class="story-label">Events</span>
                    </div>
                </div>
                    {% endif %}
            </div>
            <div id="stories-pager" class="clearfix"></div>
       </section><!-- /#rotator -->
    </div>
    <div class="container primary">
        <section id="home-content">
            <div id="sections" class="clearfix">
                {% theme_include "sidebar.html" %}
                <section id="about-info">
                    <h2>About {{ SITE_GLOBAL_SITEDISPLAYNAME }}</h2>
                    <div class="blurb">
                        <p>We're a Public Relations firm. You should join us so that we can hook you up with all of our knowledge and introduce you to all of our peeps. We've been in business for sometimes which means we know something. Most of our peeps have big money which means people will listen when we network.</p>
                    </div>
                </section><!-- /#about-info -->
                <section id="about-img">
                    <img src="http://media.tendenciapp.com/images/photo.jpg" />
                </section><!-- /#about-img -->
                <div class="separator"></div>
                {% list_news as featured_news limit=8 %}
                <section id="news-featured">
                    <h2>News</h2>
                    
                    {% if featured_news %}
                    {% for news_item in featured_news|slice:":1" %}
                        <p>{{ news_item.body|striptags|truncatewords:40|safe }} <a class="readmore" href="{% url news.view news_item.slug %}">Read more</a></p>
                    {% endfor %}
                    {% else %}
                        <p>Tendenci supports great news updates for your members and website visitors. You can pull extra details from the latest news, while showing other news items to the side. {% if request.user.is_authenticated %}<a href="/news/add/">Add your first news item</a> to take the place of these examples.{% endif %}</p> <a href="/">Read more</a>
                    {% endif %}
                </section>
                <section id="news-others">
                    <ul id="news-items">
                        {% if featured_news|length > 1 %}
                        {% for news_item in featured_news %}
                            {% if forloop.first %}
                            {% else %}
                            <li><a href="{% url news.view news_item.slug %}">{{ news_item.headline|truncatewords:4|safe }}</a></li>
                            {% endif %}
                        {% endfor %}
                        {% else %}
                        <li>Another top story in the news</li>
                        <li>Even more great news updates</li>
                        {% endif %}
                    </ul>
                </section>
            </div>
        </section><!-- /#home-content -->
    </div>
    <div class="container">
        <section id="footer">
        <footer class="clearfix">
            {% theme_include "footer.html" %}
        </footer>
        </section><!-- /#footer -->
    </div>
</div>
{% endblock %}

{% block extra_body %}
{{ block.super }}
    <script src="{{ THEME_URL }}media/js/jquery.cycle.all.min.js" type="text/javascript"></script>
    <script type="text/javascript">
    function clearDefault(val) {  
        if (val.defaultValue==val.value) val.value = "" 
    } 
    $(document).ready(function() {
        $("#stories").cycle({
            timeout: 6000,
            speed: 2000,
            pager: '#stories-pager',
            pagerEvent: 'mouseover',
            pagerAnchorBuilder: function(index, panel) { 
                var title = $('#story-label-'+index).text();
                return '<a href="#">'+ title +'</a>'; 
            }
        });
    });
    </script>
{% endblock extra_body %}