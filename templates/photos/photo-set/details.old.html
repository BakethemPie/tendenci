{% extends "photos/base.html" %}

{% load i18n %}
{% load humanize %}
{% load pagination_tags %}
{% load tagging_tags %}
{% load group_tags %}
{% load threadedcommentstags %}
{% load theme_tags %}

{% block head_title %}{{ photo_set.name }}{% endblock %}

{% block body %}
<style type="text/css">
	div.gallery-photo-thumb {
		margin: 0 5px 5px;
	    float: left;
		text-align: center;
	}
	div.gallery-photo-thumb img {
		display: block;
	}
</style>
    
    <h1>{{ photo_set.name }}</h1>
    
    {% if photos %}
    {% autopaginate photos 28 %}
        <div class="thumb-row clearfix">
        {% for photo in photos %}
        <div class="gallery-photo-thumb">
            <a href="{% url photo photo.id photo_set.id %}"><img src="{{ photo.get_small_crop_url }}" alt="{{ photo.title }}"/></a>
            <div>From <a href="{% url profile_detail photo.member.username %}">{{ photo.member.username }}</a></div>
        </div>
        {% endfor %}
        </div>
        {% paginate %}
    {% else %}
        <p>{% trans "No photos were found." %}</p>
    {% endif %}
{% endblock %}

{% block extra_body %}
<script type="text/javascript">

var dropbox;
dropbox = document.getElementById("dropbox");

// bind event-handler listeners
dropbox.addEventListener("dragenter", dragenter, false);
dropbox.addEventListener("dragover", dragover, false);
dropbox.addEventListener("drop", drop, false);

// event handler
function dragenter(e) {
  e.stopPropagation();
  e.preventDefault();
}
// event handler
function dragover(e) {
  e.stopPropagation();
  e.preventDefault();
}
// event handler
function drop(e) {
  e.stopPropagation();
  e.preventDefault();

  var dt = e.dataTransfer;
  var files = dt.files;

  handleFiles(files);
}

// handle files
function handleFiles(files) {
  for (var i = 0; i < files.length; i++) {
    var file = files[i];
    var imageType = /image.*/;
    
    if (!file.type.match(imageType)) {
      continue;
    }
    
    var img = document.createElement("img");
    img.classList.add("obj");
    img.file = file;
    preview.appendChild(img);
    
    var reader = new FileReader();
    reader.onload = (function(aImg) { return function(e) { aImg.src = e.target.result; }; })(img);
    reader.readAsDataURL(file);
  }
}

</script>
{% endblock %}













