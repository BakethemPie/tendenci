{% extends "photos/base.html" %}

{% load i18n %}
{% load pagination_tags %}
{% load photo_tags %}

{% block head_title %}{% blocktrans %}Latest Photo Sets{% endblocktrans %}{% endblock %}
{% block extra_head %}
	<style type="text/css">
		.photo-set {
			border: 1px solid #CCC;
			padding: 10px;
			margin: 10px 0;
		}
		.photo-set table {
			width: 100%;
		}
		.photo-set table td {
			vertical-align: top;
		}
		.photo-set table td.image {
			width: 1%;
		}
		.photo-set table td.image img {
			padding: 5px;
			margin: 0 10px 0 0;
			border: 1px solid silver;
		}
		.photo-set table td.info h2 {
			margin: 0;
		}
		.photo-set table td.info div.actions a {
			margin: 0 1px;
		}
	</style>
{% endblock %}

{% block body %}

    <div id="photo-sets-header-wrap">
        <h1>{% trans "Latest Photo Sets" %}</h1>
        <form name="search-photo-sets" method="get" action="">
        <input type="text" id="search-photo-sets" name="q" value="{{ q }}" /></form>
    </div>

    {% autopaginate photo_sets %}

    {% if photo_sets %}

        {% for photo_set in photo_sets %}
		{% with photo_set.object as photo_set %}
		<div class="photo-set">
        	<table><tr>
            	<td class="image">
                	<a href="{{ photo_set.get_absolute_url }}"><img src="{{ photo_set.get_cover_photo }}" /></a>
                </td>
                <td class="info">
                	<h2><a href="{{ photo_set.get_absolute_url }}">{{ photo_set.name }}</a></h2>
					<div>{{ photo_set.image_set.count }} photo{{ photo_set.image_set.count|pluralize }} </div>
                    <div class="description">{{ photo_set.description|striptags|truncatewords_html:25 }}</div>
                    <div class="actions">
						{% if perms.photos.change_photoset %}
                            <a href="{% url photoset_edit photo_set.id %}">Edit Set</a> 
						{% endif %}
						{% if perms.photos.delete_photoset %}
                            <a class="delete-set" href="{% url photoset_delete photo_set.id %}">Delete Set</a>
						{% endif %}
						{% if perms.photologue.add_photo %}
                            <a href="{% url photos_batch_add photo_set.id %}">Add Photos</a>
						{% endif %}
						{% if perms.photologue.change_photo %}
                            <a href="{% url photos_batch_edit photo_set.id %}">Edit Photos</a>
						{% endif %}
                    </div>
                </td>
			</tr></table>
        </div>
        {% endwith %}
        {% endfor %}

        {% paginate %}
    {% else %}
    <p>No photo sets were found.</p>
    {% endif %}

{% endblock %}
{% block extra_body %}
<script src="{{ STATIC_URL }}js/jquery.inputfieldtext.js" type="text/javascript"></script>
<script type="text/javascript">
	$('input#search-photo-sets').inputFieldText('Search photo sets ...', 'search-photo-sets-hint');

	// photo: delete confirmation
	$('.photo-set .info .actions .delete-set').click(function(){
		var delete_photo = confirm('Permenantly delete photo set?'); // confirm
		if(!delete_photo) return false; // do not delete
	});

</script>
{% endblock %}
