{% load base_filters %}

{% with obj.registrant_set.all as registrants %}
	{% if registrants %}
		{% for reg in registrants %}
			<tr>
			    <td>
					{% if reg.user %}
						<a href="{% url profile reg.user.username %}">
					{% endif %}
					{% if reg.first_name or reg.last_name or reg.email %}
						{{ reg.first_name }} {{ reg.last_name }}
						{% if reg.email %} 
							({{ reg.email }})
						{% endif %}
					{% else %}
						Registrant {{ forloop.counter }} (name not available)
					{% endif %}
					{% if reg.user %}
						</a>
					{% endif %}
				</td>
				<td class="td-right">
				    {{ reg.amount|format_currency }}
				</td>
			</td>
		{% endfor %}
	{% endif %}
{% endwith %}