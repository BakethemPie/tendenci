{% extends "events/base.html" %}
{% load event_tags %}
{% load perm_tags %}
{% load styled_forms %}


{% block title %}{{ block.super }}Edit{% endblock %}

{% block extra_head %}
{{ block.super }}
<link rel="stylesheet" href="{{ STATIC_URL }}css/jquery-ui/jquery-ui-1.8.2.custom.css">
<link rel="stylesheet" href="{{ STATIC_URL }}css/timepicker.css" />
<link rel="stylesheet" href="{{ STATIC_URL }}css/events.css">
<script type="text/javascript" src="{{ STATIC_URL }}tinymce/tiny_mce.js"></script>
{% endblock %}

{% block body %}
<div class="t">
    {% event_nav request.user %}

    <h1>{% firstof MODULE_EVENTS_LABEL 'Event' %} Edit</h1>

    <div class="event-wrap">

		<div class="options">
             <div class="quick-options">
				{% event_options request.user event %} 	       
             </div>
		</div>

    	<form action="{% url event.edit event.pk %}" method="post" enctype="multipart/form-data">
    	<div class="forms">
			{{ multi_event_forms|styled_multi_forms }}
            <div class="form-label">Speakers</div> 
            {{ form_speaker.management_form }}
            <div id="form-speaker">
                {{ form_speaker|styled_form_set }}
                <input type="button" value="Add More" id="add_more">
            </div>
            <div class="form-label">Group Pricing</div>
            {{ form_grpregconf.management_form }}
            {% if form_grpregconf.errors %}
            <div class="errors">
            There were some problems in the formset. Please review. Thanks!
            </div>
            {% endif %}
                
            <div id="form-grpregconf">
                {% for form in form_grpregconf.forms %}
                    <div class="form-grouping{% cycle ' alt' '' %}">
                    {% if form.non_field_errors %}
                        <div class ="errors">
                            {% for error in form.non_field_errors %}
                                <p>{{ error }}</p>
                            {% endfor %}
                        </div>
                    {% endif %}
                    {{ form.id }}
                    <div class="form-field">
                        <div class="{{ form.group.auto_id }}">
                            <div class="label{% if form.group.field.required %} required{% endif %}">
                                {{ form.group.label_tag }}
                            </div>
                            {% if form.group.errors %}
                            <div class="error">
                                {% for error in form.group.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %}   
                            <div class="field">
                                {{ form.group }}
                            </div>  
                            {% if form.group.help_text %}
                            <div class="help-text">{{ form.group.help_text }}</div>   
                            {% endif %}
                            </div>
                        </div>
                    <div class="form-field"> 
                        <div class="id_regconf-reg8n_dt_price">
                            <div class="label"> 
                                <label for="id_regconf-reg8n_dt_price">Times and Pricing</label> 
                            </div>
                            {% if form.early_price.errors %}
                            <div class="error">
                                {% for error in form.early_price.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %}
                            {% if form.early_dt.errors %}
                            <div class="error">
                                {% for error in form.early_dt.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %} 
                            {% if form.regular_price.errors %}
                            <div class="error">
                                {% for error in form.regular_price.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %} 
                            {% if form.regular_dt.errors %}
                            <div class="error">
                                {% for error in form.regular_dt.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %} 
                            {% if form.late_price.errors %}
                            <div class="error">
                                {% for error in form.late_price.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %} 
                            {% if form.late_dt.errors %}
                            <div class="error">
                                {% for error in form.late_dt.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %}
                            {% if form.end_dt.errors %}
                            <div class="error">
                                {% for error in form.end_dt.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %} 
                            <div class="field">
                                <div>{{ form.early_price }}
                                    after {{ form.early_dt }}
                                </div> 
                                <div>{{ form.regular_price }}
                                    after {{ form.regular_dt }}
                                </div> 
                                <div>{{ form.late_price }}
                                    after {{ form.late_dt }}
                                </div> 
                                <div>registration ends 
                                    {{ form.end_dt }}
                                </div> 
                                </div>
                         </div> 
                    </div>
                </div>
                {% endfor %}
                <input type="button" value="Add More" id="add_more2">
            </div>
            
            <div class="form-label">Special Pricing</div>
            {{ form_special.management_form }}
            {% if form_special.errors %}
            <div class="errors">
                There were some problems in the formset. Please review. Thanks!
            </div>
            {% endif %}
            <div id="form-special">
                {% for form in form_special.forms %}
                    <div class="form-grouping{% cycle ' alt' '' %}">
                    {% if form.non_field_errors %}
                        <div class ="errors">
                            {% for error in form.non_field_errors %}
                                <p>{{ error }}</p>
                            {% endfor %}
                        </div>
                    {% endif %}
                    {{ form.id }}
                    <div class="form-field">
                        <div class="{{ form.title.auto_id }}">
                            <div class="label{% if form.title.field.required %} required{% endif %}">
                                {{ form.title.label_tag }}
                            </div>
                            {% if form.title.errors %}
                            <div class="error">
                                {% for error in form.title.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %}   
                            <div class="field">
                                {{ form.title }}
                            </div>  
                            {% if form.title.help_text %}
                            <div class="help-text">
                                {{ form.title.help_text }}
                            </div>   
                            {% endif %}
                        </div>
                    </div>
                    <div class="form-field">
                        <div class="{{ form.quantity.auto_id }}">
                            <div class="label{% if form.quantity.field.required %} required{% endif %}">
                                {{ form.quantity.label_tag }}
                            </div>
                            {% if form.quantity.errors %}
                            <div class="error">
                                {% for error in form.quantity.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %}   
                            <div class="field">
                                {{ form.quantity }}
                            </div>  
                            {% if form.quantity.help_text %}
                            <div class="help-text">
                                {{ form.quantity.help_text }}
                            </div>   
                            {% endif %}
                        </div>
                    </div>
                    <div class="form-field">
                        <div class="{{ form.group.auto_id }}">
                            <div class="label{% if form.group.field.required %} required{% endif %}">
                                {{ form.group.label_tag }}
                            </div>
                            {% if form.group.errors %}
                            <div class="error">
                                {% for error in form.group.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %}   
                            <div class="field">
                                {{ form.group }}
                            </div>  
                            {% if form.group.help_text %}
                            <div class="help-text">
                                {{ form.group.help_text }}
                            </div>   
                            {% endif %}
                        </div>
                    </div>
                    <div class="form-field"> 
                        <div class="id_regconf-reg8n_dt_price">
                            <div class="label"> 
                                <label for="id_regconf-reg8n_dt_price">Times and Pricing</label> 
                            </div>
                            {% if form.early_price.errors %}
                            <div class="error">
                                {% for error in form.early_price.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %}
                            {% if form.early_dt.errors %}
                            <div class="error">
                                {% for error in form.early_dt.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %} 
                            {% if form.regular_price.errors %}
                            <div class="error">
                                {% for error in form.regular_price.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %} 
                            {% if form.regular_dt.errors %}
                            <div class="error">
                                {% for error in form.regular_dt.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %} 
                            {% if form.late_price.errors %}
                            <div class="error">
                                {% for error in form.late_price.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %} 
                            {% if form.late_dt.errors %}
                            <div class="error">
                                {% for error in form.late_dt.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %}
                            {% if form.end_dt.errors %}
                            <div class="error">
                                {% for error in form.end_dt.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %} 
                            <div class="field">
                                <div>{{ form.early_price }}
                                    after {{ form.early_dt }}
                                </div> 
                                <div>{{ form.regular_price }}
                                    after {{ form.regular_dt }}
                                </div> 
                                <div>{{ form.late_price }}
                                    after {{ form.late_dt }}
                                </div> 
                                <div>registration ends 
                                    {{ form.end_dt }}
                                </div> 
                                </div>
                         </div> 
                    </div>
                </div>
                {% endfor %}
                <input type="button" value="Add More" id="add_more3">
            </div>
            
			<input type="submit" value="Save Changes" />
		</div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_body %}
    {{ block.super }}
    <script type="text/javascript" src="{{ STATIC_URL }}js/global/tinymce.event_handlers.js"></script>
	<script type="text/javascript" src="{{ STATIC_URL }}js/jquery-ui-1.8.2.custom.min.js"></script>
	<script src="{{ STATIC_URL }}js/jquery.time.picker.js" type="text/javascript"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/formset.js"></script>
    <script type="text/javascript">
		$(document).ready(function(){
			// delete confirmation
			$('.delete').click(function(){
				var delete_object = confirm("Permenantly delete {% firstof MODULE_EVENTS_LABEL 'Event' %}?");	// confirm
				if(delete_object) $('form[name="event-delete"]').submit()
				return false;	// cancel
			});
		});
    </script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/global/dropdown.js"></script>
	<script type="text/javascript">
	var iconrow = new dropdown({
		container:	'more-options-wrap',
		trigger:	'more-options-trigger',
		target:		'more-options-target'
	});
	</script>
	<script type="text/javascript">
		$(".datepicker").datepicker({ dateFormat: 'yy-mm-dd' });
		$('.timepicker').timePicker({
		  show24Hours: false,
		  step: 15
		});
	</script>
    <script>
        $(document).ready(function(){
            $('#add_more').click(function() {
                cloneForm('#form-speaker div.form-grouping:last', '{{ form_speaker.prefix }}');
            });
            $('#add_more2').click(function() {
                cloneForm('#form-grpregconf div.form-grouping:last', '{{ form_grpregconf.prefix }}');
            });
            $('#add_more3').click(function() {
                cloneForm('#form-grpregconf div.form-grouping:last', '{{ form_grpregconf.prefix }}');
            });
        });
    </script>
{% endblock %}
